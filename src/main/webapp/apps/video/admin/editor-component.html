<script>
	function appAfterInit(response, datatable) {
		const setFieldsVisibility = (fieldsToHide = [], fieldsToShow = []) => {
            console.log("hide:", fieldsToHide );
            console.log("show:", fieldsToShow );
			fieldsToHide.forEach((name) => $(`.DTE_Field_Name_${name}`).hide());
			fieldsToShow.forEach((name) => $(`.DTE_Field_Name_${name}`).show());
		};

		window.addEventListener("WJ.DTE.opened", function (e) {
			const youtube = $("#DTE_Field_field_0");
			const vimeo = $("#DTE_Field_field_1");
			const facebook = $("#DTE_Field_field_2");
			const video = $("#DTE_Field_field_3");
            const fixed = $("#DTE_Field_widthType_0");
            const responsive = $("#DTE_Field_widthType_1");

            if (!(youtube.is(":checked") || vimeo.is(":checked") || facebook.is(":checked") || video.is(":checked"))) {
                setFieldsVisibility([ "videoAlignFacebook","videoAlignVimeo", "portrait", "byline", "badge","file","widthType","videoAlignYT","width","height","percentageWidth","autoplay","fullscreen","showinfo","controls","branding","rel"], []);
            }

            const handleSizeFields = () => {
                fixed.off("change").on("change", function () { 
                    if ($(this).is(":checked")) {
                        if ($(facebook).is(":checked")) {
                            setFieldsVisibility(["percentageWidth"], ["width"]);
                        } else {
                            setFieldsVisibility(["percentageWidth"], ["height", "width"]);
                        }
                    }
                });

                responsive.off("change").on("change", function () {
                    if ($(this).is(":checked")) {
                        if ($(facebook).is(":checked")) {
                            setFieldsVisibility(["height", "width", "percentageWidth"], []);
                        } else {
                            setFieldsVisibility(["height", "width"], ["percentageWidth"]);
                        }
                    }
                });
            };

			youtube.off("change").on("change", function () {
				if ($(this).is(":checked")) {
					setFieldsVisibility(["videoAlignVimeo", "videoAlignFacebook", "portrait", "byline", "badge"], ["file", "widthType", "videoAlignYT", "width", "height", "percentageWidth", "autoplay", "fullscreen", "showinfo", "controls", "branding", "rel"]);
                    handleSizeFields();
                }     
            });

            vimeo.off("change").on("change", function () {
				if ($(this).is(":checked")) {
					setFieldsVisibility(["videoAlignFacebook", "videoAlignYT", "controls", "branding", "rel"], ["file", "videoAlignVimeo", "widthType", "width", "height", "percentageWidth", "autoplay", "fullscreen", "showinfo", "portrait", "byline", "badge"]);
                    handleSizeFields();    
                }      
            });

            facebook.off("change").on("change", function () {
				if ($(this).is(":checked")) {
					setFieldsVisibility(["videoAlignYT", "controls", "branding", "rel", "videoAlignVimeo", "portrait", "badge", "height", "percentageWidth"], ['videoAlignFacebook', "file", "width", "widthType", "autoplay", "fullscreen", "showinfo", "byline"]);
                    handleSizeFields();
                }
            });

            video.off("change").on("change", function() {
                if ($(this).is(":checked")) {
					setFieldsVisibility(["videoAlignYT", "controls", "branding", "rel", "videoAlignVimeo", "portrait", "badge", "height", "percentageWidth", 'videoAlignFacebook', "autoplay", "fullscreen", "showinfo", "byline"], [ "file", "width", "widthType"]);
                    handleSizeFields();
                }

            })

            youtube.trigger('change');
            vimeo.trigger('change');
            facebook.trigger('change');
            video.trigger('change');
            fixed.trigger('change');
            responsive.trigger('change');
		});
	}
</script>